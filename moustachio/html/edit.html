<!DOCTYPE HTML>
<head>
  <title>Moustache Image</title>
  <script src="http://code.jquery.com/jquery-2.1.0.min.js"></script>
  <meta charset = "UTF-8" />
  <script type="text/javascript">
    var fn = function() {
      var id     = "{{.}}";
      var img    = "/img?";
      var share  = "/share?";

      var x      = 0;
      var y      = 0;

      var $pic   = $("#pic");
      var $url   = $("#url");
      var $s     = $("#size");
      var $d     = $("#droop");
      var $surl  = $("a.surl");

      function update() {
        var query       = "id="+id+"&x="+x+"&y="+y+"&s="+$s.val()+"&d="+$d.val();
        var image_query = img+query;
        var share_query = share+query;
        $url.text(image_query);
        $pic.attr("src", image_query);
        $surl.attr("href", share_query);
      }

      var pic_click = function(e) {
        x = e.pageX - this.offsetLeft;
        y = e.pageY - this.offsetTop;
        update();
      }

      $pic.click(pic_click);
      $s.bind("mouseup", update);
      $d.bind("mouseup", update);

      update();
    }
    $(document).ready(fn);
  </script>
</head>
<body>
  <h2>Add Moustache: Choose slider values for effect </h2>
  <p>Image: <code id="url" /></p>
  <p>
    <input id="size" type="range" min="-10" max="10" step="1" value="0">
    <input id="droop" type="range" min="-30" max="30" step="1" value="0">
    <a class="surl" href="#">Upload Image</a>
  </p>
  <p>Click the image to place the moustache.</p>
  <img id="pic" />
</body>
</html>
